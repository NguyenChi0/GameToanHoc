CREATE DATABASE gametoanhoc;
USE gametoanhoc;

-- 2. Bảng tài khoản người chơi
CREATE TABLE taikhoan (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(100) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    score INT DEFAULT 0,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- 3. Bảng danh mục phép toán
CREATE TABLE categories (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL        -- VD: "Tổng", "Hiệu", "Tích", "Thương", "Hỗn hợp"
);

-- 4. Bảng bài học
CREATE TABLE lessons (
    id INT AUTO_INCREMENT PRIMARY KEY,
    category_id INT,
    name VARCHAR(100) NOT NULL,      -- VD: "Tổng trong phạm vi 10"
    required_score INT DEFAULT 0,    -- Điểm cần để mở bài này
	file VARCHAR(255),
    FOREIGN KEY (category_id) REFERENCES categories(id)
);

-- 5. Bảng kết quả học
CREATE TABLE lesson_results (
    id INT AUTO_INCREMENT PRIMARY KEY,
    taikhoan_id INT,
    lesson_id INT,
    total_questions INT,       -- Tổng số câu
    correct_answers INT,       -- Số câu đúng
    total_score INT,           -- Tổng điểm
    played_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (taikhoan_id) REFERENCES taikhoan(id),
    FOREIGN KEY (lesson_id) REFERENCES lessons(id)
);

-- (Tùy chọn) 6. Bảng các bài học đã được mở khóa
CREATE TABLE unlocked_lessons (
    id INT AUTO_INCREMENT PRIMARY KEY,
    taikhoan_id INT,
    lesson_id INT,
    unlocked_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (taikhoan_id) REFERENCES taikhoan(id),
    FOREIGN KEY (lesson_id) REFERENCES lessons(id)
);

INSERT INTO categories (name) VALUES ('Tổng'), ('Hiệu'), ('Tích'), ('Thương'),('Hỗn hợp');

INSERT INTO lessons (category_id, name, required_score, file) VALUES
(1, 'Tổng các phép toán 1 chữ số', 10, 'Tong1cs.html'),
(1, 'Tổng các phép toán 2 chữ só', 10, 'Tong2cs.html'),
(1, 'Tổng các phép toán 3 chữ số', 10, 'Tong3cs.html'),
(2, 'Hiệu các phép toán 1 chữ số', 10, 'Hieu1cs.html'),
(2, 'Hiệu các phép toán 2 chữ số', 10, 'Hieu2cs.html'),
(2, 'Hiệu các phép toán 3 chữ số', 10, 'Hieu3cs.html'),
(3, 'Tích các phép toán 1 chữ số', 10, 'Tich1cs.html'),
(3, 'Tích các phép toán 2 chữ số', 10, 'Tich2cs.html'),
(3, 'Tích các phép toán 3 chữ số', 10, 'Tich3cs.html'),
(4, 'Thương các phép toán 1 chữ số', 10, 'Thuong1cs.html'),
(4, 'Thương các phép toán 2 chữ số', 10, 'Thuong2cs.html'),
(4, 'Thương các phép toán 3 chữ số', 10, 'Thuong3cs.html'),
(5, 'Hỗn hợp các phép toán 1 chữ số', 10, 'Honhop1cs.html'),
(5, 'Hỗn hợp các phép toán 2 chữ số', 10, 'Honhop2cs.html'),
(5, 'Hỗn hợp các phép toán 3 chữ số', 10, 'Honhop3cs.html');


select * from lessons
select * from categories